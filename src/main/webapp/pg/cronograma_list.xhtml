<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	template="../template/plantilla.xhtml">
	<ui:define name="head">:: Gestión de documentos ::</ui:define>
	<ui:define name="content">
		<h1 class="title ui-widget-header ui-corner-all" align="center" >Cronogramas</h1>
		<div class="entry" style="line-height:200%;margin-left:100px">
			
			<p:ajaxStatus style="width:16px;height:16px;">
                <f:facet name="start">
                    <h:graphicImage value="../design/ajaxloading.gif" />
                </f:facet>

                <f:facet name="complete">
                    <h:outputText value="" />
                </f:facet>
            </p:ajaxStatus>
            

        <h:form id="form" >
        	<p:growl id="messages"/>        	
            <p:dataTable  var="cronograma" value="#{cronogramaListMB.cronogramas}"  id="cronogramas"  editable="true" paginator="true" paginatorPosition="bottom" rows="10">
				        
                <p:column headerText="Nombre" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{cronograma.nombre}" />                                              
                </p:column>  
                
                <p:column headerText="Sigla" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{cronograma.sigla}" />                                              
                </p:column>  
                
                <p:column style="width:30px;" >				
					<p:commandButton action="#{cronogramaListMB.getNextView}" actionListener="#{cronogramaListMB.clear}"
						value ="Editar" ajax="false" icon="ui-icon-pencil" >
						<f:param name="id" value="#{cronograma.cronogramaId}" />
					</p:commandButton>
				</p:column>
				<p:column style="width:50px;" headerText="" >
                    <p:commandLink id="showDialogButton" onclick="confirmation.show();">
                        <span class="ui-icon ui-icon-trash" title="Eliminar">  </span> 
                        <f:setPropertyActionListener value="#{cronograma}" target="#{cronogramaListMB.cronogramaSeleccionado}" />
                    </p:commandLink>
                </p:column>
            
            	<p:column style="width:50px;" headerText="" >
                    <p:commandLink update=":form:messages, :form2:detalles, :form3:panel3"  action="#{cronogramaListMB.elegirCronograma}" >
                        <span class="ui-icon ui-icon-calculator" title="Ver Detalles">  </span> 
                        <f:setPropertyActionListener value="#{cronograma}" target="#{cronogramaListMB.cronogramaSeleccionado}" />
                    </p:commandLink>
                </p:column>
            </p:dataTable>
            
            <p:confirmDialog id="confirmDialog" message="¿Desea eliminar el Cronograma?"
                             header="Eliminar?" severity="alert" widgetVar="confirmation">
                <p:commandButton id="confirm" value="Si" oncomplete="confirmation.hide()" 
                                 actionListener="#{cronogramaListMB.eliminar}" update="cronogramas, messages" />
                <p:commandButton id="decline" value="No" onclick="confirmation.hide()" type="button" /> 
            </p:confirmDialog>
            
            <br></br>
				<p:toolbarGroup>
					<p:commandButton value ="Nuevo " action="#{cronogramaListMB.getNextView}"
						actionListener="#{cronogramaListMB.clear}" ajax="false" image="ui-icon-document" />
 				</p:toolbarGroup>
        </h:form>
        
        <br></br>
        <h:form id="form2" >
        	
            <p:dataTable  id="detalles" var="detalle" value="#{cronogramaListMB.detalles}"  editable="true" paginator="true" paginatorPosition="bottom" rows="10">
				<f:facet name="header">  
		            Detalles  #{cronogramaListMB.cronogramaSeleccionado.nombre}
		        </f:facet> 
                <p:column width="90" headerText="Descrip" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{detalle.tarea}" />                                              
                </p:column>
                <p:column headerText="NroOrden" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{detalle.nroOrden}" />                                              
                </p:column>
                <p:column width="70" headerText="RolResp" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{detalle.rolResponsable.descripcion}" />                                              
                </p:column>
                <p:column headerText="AlerIni" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{detalle.alertaInicio}" />                                              
                </p:column>
                <p:column headerText="Duracion" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{detalle.duracionTarea}" />                                              
                </p:column>
                <p:column headerText="Alarma" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{detalle.alarma.descripcion}" />                                              
                </p:column>
                <p:column headerText="Alerta" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{detalle.alerta.descripcion}" />                                              
                </p:column>
                <p:column headerText="Pregunta" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{detalle.pregunta.descripcion}" />                                              
                </p:column>
                <p:column headerText="TareaSi" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{detalle.respuestaSi.tarea}" />                                              
                </p:column>
                <p:column headerText="TareaNo" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{detalle.respuestaNo.tarea}" />                                              
                </p:column>
                <p:column headerText="TareaSgte" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{detalle.tareaSiguiente.tarea}" />                                              
                </p:column>               
              	
              	<p:column headerText="Checklist" style="font-weight:bold;" >
                     <h:outputText style="font-weight:normal;" value="#{detalle.checklist.descripcion}" />                                              
                </p:column>
                
              	<p:column style="width:50px;" headerText="" >
                    <p:commandLink update=":form:messages,:form4:panel4" onclick="dlg2.show()" action="#{cronogramaListMB.elegirDetalle}" >
                        <span class="ui-icon ui-icon-pencil" title="Editar">  </span> 
                        <f:setPropertyActionListener value="#{detalle}" target="#{cronogramaListMB.detalleSeleccionado}" />
                    </p:commandLink>
                </p:column>   
                <p:column style="width:50px;" headerText="" >
                    <p:commandLink id="showDialogButton2" onclick="confirmation2.show();">
                        <span class="ui-icon ui-icon-trash" title="Eliminar">  </span> 
                        <f:setPropertyActionListener value="#{detalle}" target="#{cronogramaListMB.detalleSeleccionado}" />
                    </p:commandLink>
                </p:column>
            </p:dataTable>   
            <p:confirmDialog id="confirmDialog2" message="¿Desea eliminar el Detalle?"
                             header="Eliminar?" severity="alert" widgetVar="confirmation2">
                <p:commandButton id="confirm" value="Si" oncomplete="confirmation2.hide()" 
                                 actionListener="#{cronogramaListMB.eliminarDetalle}" update=":form:messages,:form2:detalles" />
                <p:commandButton id="decline" value="No" onclick="confirmation2.hide()" type="button" /> 
            </p:confirmDialog>
                    
          				
           </h:form>
        
        	<br></br> 
       	 	<p:commandButton id="showDialogButton3" type="button" value="Nuevo Detalle" onclick="dlg.show()" />
          	<br></br> 
        	         	
			<p:dialog header="Nuevo Detalle" widgetVar="dlg" resizable="false">  
				
				<h:form id="form3">       		
                        <p:panel style="width:500px"  id="panel3" >
                            <h:panelGrid columns="2" cellpadding="5" >

			                    <h:outputText value="NroOrden" />
                                <p:inputText value="#{cronogramaListMB.nroOrden}"/>

                            	<h:outputText value="Descripcion" />
                                <p:inputText value="#{cronogramaListMB.tarea}" required="true" maxlength="50" size="50"/>
                                				
			                    <h:outputText value="RolResponsable: " /> 
			                    <p:selectOneMenu id="selectRolResp" value="#{cronogramaListMB.idRolResponsable}" >  
			                        <f:selectItem itemLabel="Seleccione Rol-Resp" itemValue="" />  
			                        <f:selectItems value="#{cronogramaListMB.roles}" var="rol" itemLabel="#{rol.descripcion}" itemValue="#{rol.rolId}" />                                  
			                    </p:selectOneMenu>
			                    
			                    <h:outputText value="AlertaInicio: " /> 
			                    <p:selectOneMenu id="selectAlerIni" value="#{cronogramaListMB.alertaInicio}" >
			                    	<f:selectItem itemLabel="Si" itemValue="Si" />
	                            	<f:selectItem itemLabel="No" itemValue="No" />	                            
			                    </p:selectOneMenu>
			                    
			                    <h:outputText value="Duracion(Días)" />
                                <p:inputText value="#{cronogramaListMB.duracionTarea}"/>
			                    
			                    <h:outputText value="Alarma: " /> 
			                    <p:selectOneMenu id="selectAlarma" value="#{cronogramaListMB.idAlarma}" >  
			                        <f:selectItem itemLabel="Seleccione Alarma" itemValue="" />  
			                        <f:selectItems value="#{cronogramaListMB.alarmas}" var="alarma" itemLabel="#{alarma.descripcion}" itemValue="#{alarma.tipoAlarmaId}" />                                  
			                    </p:selectOneMenu>
			                    
			                    <h:outputText value="Alerta: " /> 
			                    <p:selectOneMenu id="selectAlerta" value="#{cronogramaListMB.idAlerta}" >  
			                        <f:selectItem itemLabel="Seleccione Alerta" itemValue="" />  
			                        <f:selectItems value="#{cronogramaListMB.alertas}" var="alerta" itemLabel="#{alerta.descripcion}" itemValue="#{alerta.tipoAlarmaId}" />                                  
			                    </p:selectOneMenu>
			                    
			                    <h:outputText value="TareaSgte: " /> 
			                    <p:selectOneMenu id="selectTareaSgte" disabled="#{cronogramaListMB.checkPregunta}" value="#{cronogramaListMB.idTareaSgte}" >  
			                        <f:selectItem itemLabel="Seleccione TareaSgte" itemValue="" />  
			                        <f:selectItems value="#{cronogramaListMB.tareas}" var="tareaSgte" itemLabel="#{tareaSgte.tarea}" itemValue="#{tareaSgte.cronogramaDetalleId}" />                                  
			                    </p:selectOneMenu>
			                    
			                    <p:selectBooleanCheckbox id="checkPregunta" value="#{cronogramaListMB.checkPregunta}"> 
			                     	<p:ajax update="selectPregunta, selectTareaSi, selectTareaNo, selectTareaSgte "/>
        						</p:selectBooleanCheckbox>
			                    <br></br>
			                    
			                    <h:outputText value="Pregunta: " /> 
			                    <p:selectOneMenu id="selectPregunta" disabled="#{!cronogramaListMB.checkPregunta}" value="#{cronogramaListMB.idPregunta}" >  
			                        <f:selectItem itemLabel="Seleccione Pregunta" itemValue="" />  
			                        <f:selectItems value="#{cronogramaListMB.preguntas}" var="pregunta" itemLabel="#{pregunta.descripcion}" itemValue="#{pregunta.preguntaId}" />                                  
			                    </p:selectOneMenu>
			                    
			                    <h:outputText value="TareaSi: " /> 
			                    <p:selectOneMenu id="selectTareaSi" disabled="#{!cronogramaListMB.checkPregunta}" value="#{cronogramaListMB.idTareaSi}" >  
			                        <f:selectItem itemLabel="Seleccione TareaSi" itemValue="" />  
			                        <f:selectItems value="#{cronogramaListMB.tareas}" var="tareaSi" itemLabel="#{tareaSi.tarea}" itemValue="#{tareaSi.cronogramaDetalleId}" />                                  
			                    </p:selectOneMenu>
			                    
			                    <h:outputText value="TareaNo: " /> 
			                    <p:selectOneMenu id="selectTareaNo" disabled="#{!cronogramaListMB.checkPregunta}" value="#{cronogramaListMB.idTareaNo}" >  
			                        <f:selectItem itemLabel="Seleccione TareaNo" itemValue="" />  
			                        <f:selectItems value="#{cronogramaListMB.tareas}" var="tareaNo" itemLabel="#{tareaNo.tarea}" itemValue="#{tareaNo.cronogramaDetalleId}" />                                  
			                    </p:selectOneMenu>
			        			
			        			<h:outputText value="Checklist: " /> 
			                    <p:selectOneMenu id="selectChecklist" value="#{cronogramaListMB.idChecklist}" >  
			                        <f:selectItem itemLabel="Seleccione Checklist" itemValue="" />  
			                        <f:selectItems value="#{cronogramaListMB.checklists}" var="checklist" itemLabel="#{checklist.descripcion}" itemValue="#{checklist.checklistId}" />                                  
			                    </p:selectOneMenu>
			                                
			                    <br></br>
                                <p:commandButton value="Guardar" id="agregar" actionListener="#{cronogramaListMB.registrarCronogramaDetalle}"
                                             oncomplete="dlg.hide()" icon="ui-icon-disk" update=":form:messages,:form2:detalles,panel3"/>                             
			                    
                            </h:panelGrid>
                        </p:panel>      
                    </h:form>
            	</p:dialog>          
                    
                    <br></br>
          			<br></br>

			
			<p:dialog header="Editar Detalle" widgetVar="dlg2" resizable="false">  
		
				<h:form id="form4">
                        <p:panel style="width:500px" id="panel4" >
                            <h:panelGrid columns="2" cellpadding="5" >
                            	
                            	<h:outputText value="Descripcion" />
                                <p:inputText value="#{cronogramaListMB.detalleSeleccionado.tarea}" required="true" maxlength="50" size="50"/>
			                    
			                    <h:outputText value="NroOrden" />
                                <p:inputText value="#{cronogramaListMB.detalleSeleccionado.nroOrden}"/>
                                				
			                    <h:outputText value="RolResponsable: " /> 
			                    <p:selectOneMenu id="selectRolResp" value="#{cronogramaListMB.idRolResponsable}" >
			                    	<f:selectItem itemLabel="#{cronogramaListMB.detalleSeleccionado.rolResponsable.descripcion}" itemValue="#{cronogramaListMB.detalleSeleccionado.rolResponsable.rolId}" />  
			                        <f:selectItems value="#{cronogramaListMB.roles}" var="rol" itemLabel="#{rol.descripcion}" itemValue="#{rol.rolId}" />                                  
			                    </p:selectOneMenu>
			                    
			                    <h:outputText value="AlertaInicio: " /> 
			                    <p:selectOneMenu id="selectAlerIni" value="#{cronogramaListMB.detalleSeleccionado.alertaInicio}" >
			                    	<f:selectItem itemLabel="Si" itemValue="Si" />
	                            	<f:selectItem itemLabel="No" itemValue="No" />	                            
			                    </p:selectOneMenu>
			                    
			                    <h:outputText value="Duracion(Días)" />
                                <p:inputText value="#{cronogramaListMB.detalleSeleccionado.duracionTarea}"/>
			                    
			                    <h:outputText value="Alarma: " /> 
			                    <p:selectOneMenu id="selectAlarma" value="#{cronogramaListMB.idAlarma}" >  
			                        <f:selectItem itemLabel="#{cronogramaListMB.detalleSeleccionado.alarma.descripcion}" itemValue="#{cronogramaListMB.detalleSeleccionado.alarma.tipoAlarmaId}" /> 
			                        <f:selectItems value="#{cronogramaListMB.alarmas}" var="alarma" itemLabel="#{alarma.descripcion}" itemValue="#{alarma.tipoAlarmaId}" />                                  
									<f:selectItem itemLabel="---Ninguna---" itemValue="" />
			                    </p:selectOneMenu>
			                    
			                    <h:outputText value="Alerta: " /> 
			                    <p:selectOneMenu id="selectAlerta" value="#{cronogramaListMB.idAlerta}" >  
			                        <f:selectItem itemLabel="#{cronogramaListMB.detalleSeleccionado.alerta.descripcion}" itemValue="#{cronogramaListMB.detalleSeleccionado.alerta.tipoAlarmaId}" /> 
			                        <f:selectItems value="#{cronogramaListMB.alertas}" var="alerta" itemLabel="#{alerta.descripcion}" itemValue="#{alerta.tipoAlarmaId}" />                                  
									<f:selectItem itemLabel="---Ninguna---" itemValue="" />
			                    </p:selectOneMenu>
			                    
			                    <h:outputText value="TareaSgte: " /> 
			                    <p:selectOneMenu id="selectTareaSgte" disabled="#{cronogramaListMB.checkPregunta}" value="#{cronogramaListMB.idTareaSgte}" >  
			                        <f:selectItem itemLabel="#{cronogramaListMB.detalleSeleccionado.tareaSiguiente.tarea}" itemValue="#{cronogramaListMB.detalleSeleccionado.tareaSiguiente.cronogramaDetalleId}" />  
			                        <f:selectItems value="#{cronogramaListMB.tareas}" var="tareaSgte" itemLabel="#{tareaSgte.tarea}" itemValue="#{tareaSgte.cronogramaDetalleId}" />                                  
									<f:selectItem itemLabel="---Ninguna---" itemValue="" />
			                    </p:selectOneMenu>
			                    
								<p:selectBooleanCheckbox id="checkPregunta" value="#{cronogramaListMB.checkPregunta}"> 
			                     	<p:ajax update="selectPregunta, selectTareaSi, selectTareaNo, selectTareaSgte "/>
        						</p:selectBooleanCheckbox>
			                    <br></br>			                    
			                    
			                    
			                    <h:outputText value="Pregunta: " /> 
			                    <p:selectOneMenu id="selectPregunta" disabled="#{!cronogramaListMB.checkPregunta}" value="#{cronogramaListMB.idPregunta}" >  
			                        <f:selectItem itemLabel="#{cronogramaListMB.detalleSeleccionado.pregunta.descripcion}" itemValue="#{cronogramaListMB.detalleSeleccionado.pregunta.preguntaId}" />  
			                        <f:selectItems value="#{cronogramaListMB.preguntas}" var="pregunta" itemLabel="#{pregunta.descripcion}" itemValue="#{pregunta.preguntaId}" />                                  
									<f:selectItem itemLabel="---Ninguna---" itemValue="" />
			                    </p:selectOneMenu>
			                    
			                    <h:outputText value="TareaSi: " /> 
			                    <p:selectOneMenu id="selectTareaSi" disabled="#{!cronogramaListMB.checkPregunta}" value="#{cronogramaListMB.idTareaSi}" >  
			                        <f:selectItem itemLabel="#{cronogramaListMB.detalleSeleccionado.respuestaSi.tarea}" itemValue="#{cronogramaListMB.detalleSeleccionado.respuestaSi.cronogramaDetalleId}" /> 
			                        <f:selectItems value="#{cronogramaListMB.tareas}" var="tareaSi" itemLabel="#{tareaSi.tarea}" itemValue="#{tareaSi.cronogramaDetalleId}" />                                  
									<f:selectItem itemLabel="---Ninguna---" itemValue="" />
			                    </p:selectOneMenu>
			                    
			                    <h:outputText value="TareaNo: " /> 
			                    <p:selectOneMenu id="selectTareaNo" disabled="#{!cronogramaListMB.checkPregunta}" value="#{cronogramaListMB.idTareaNo}" >  
			                        <f:selectItem itemLabel="#{cronogramaListMB.detalleSeleccionado.respuestaNo.tarea}" itemValue="#{cronogramaListMB.detalleSeleccionado.respuestaNo.cronogramaDetalleId}" />
			                        <f:selectItems value="#{cronogramaListMB.tareas}" var="tareaNo" itemLabel="#{tareaNo.tarea}" itemValue="#{tareaNo.cronogramaDetalleId}" />                                  
									<f:selectItem itemLabel="---Ninguna---" itemValue="" />
			                    </p:selectOneMenu>
			                    
			                    <h:outputText value="Checklist: " /> 
			                    <p:selectOneMenu id="selectChecklist" value="#{cronogramaListMB.idChecklist}" >
			                        <f:selectItem itemLabel="#{cronogramaListMB.detalleSeleccionado.checklist.descripcion}" itemValue="#{cronogramaListMB.detalleSeleccionado.checklist.checklistId}" /> 
			                        <f:selectItems value="#{cronogramaListMB.checklists}" var="checklist" itemLabel="#{checklist.descripcion}" itemValue="#{checklist.checklistId}" />                                  
									<f:selectItem itemLabel="---Ninguna---" itemValue="" />
			                    </p:selectOneMenu>
			                    
			                    <br></br>
                                <p:commandButton value="Guardar" id="editar" actionListener="#{cronogramaListMB.editarCronogramaDetalle}"
                                              oncomplete="dlg2.hide()"  icon="ui-icon-disk" update=":form:messages,:form2:detalles"/>                             
			                    
                            </h:panelGrid>
                        </p:panel>      
                                    
                    </h:form>
            	</p:dialog>          
                    
		</div>
			

	</ui:define>
</ui:composition>
